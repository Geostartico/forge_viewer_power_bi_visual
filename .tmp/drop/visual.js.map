{"version":3,"file":"visual.js","mappings":"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","sources":["webpack:///./src/ExtensionGetter.ts","webpack:///./src/visual.ts","webpack:///external var \"Function('return this')()\"","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./.tmp/precompile/visualPlugin.ts"],"sourcesContent":["import {utcWednesday, NumberValue} from \"d3\";\n\nexport class ExtensionGetter{\n    \n    static SelectDesk(desk) : any{\n        class x extends desk.Viewing.Extension{\n            private modelLoaded = false;\n            private selectionStarted = false;\n            constructor(viewer, options){\n                super(viewer, options);\n            }\n            public listener(event){\n                console.log(event.dbIdArray);\n            }\n            public load() : boolean{\n                console.log(\"selection listener loaded\");\n                this.viewer.addEventListener(desk.Viewing.SELECTION_CHANGED_EVENT, this.selectionListener.bind(this));\n                this.viewer.addEventListener(desk.Viewing.MODEL_ADDED_EVENT, ((event) =>{console.log(\"modelLoaded: \");this.modelLoaded = true}).bind(this));\n                return true;\n            }\n            public unload() : boolean{\n                console.log(\"extension unloaded\");\n                return true;\n            }\n            private selectionListener(event) : void{\n                console.log(\"element selected\" + event.dbIdArray);\n                let succcallback = (dbIds) => {\n                    console.log(dbIds);\n                    for(let i = 0; i < dbIds.length; i ++){\n                        this.viewer.getProperties(dbIds[i], (prop) => {console.log(\"dbId\" + dbIds[i],prop)});\n                    }\n                    let id = dbIds[0];\n                    let tree = this.viewer.model.getInstanceTree();\n                    let i = 0\n                    while(i < 10){\n                        id = tree.getNodeParentId(id);\n                        this.viewer.getProperties(id, (prop) => {console.log(\"dbId \" + id,prop)})\n                        i++\n                    }\n\n                    this.isolateChildren(dbIds.map((elem) => {return elem/* + 1*/}));\n                    this.viewer.fitToView(dbIds);\n                    this.selectionStarted = false;\n                    \n                };\n\n                let errCallback = (err) => {console.log(\"an error has occured in the search: \" + err)};\n                //this.viewer.isolate(event.dbIdArray);\n                this.viewer.getProperties(Array.isArray(event.dbIdArray) ? event.dbIdArray[0] : event.dbIdArray, (res) => {console.log(\"dbid properties:\"); console.log(res)}, (err) => {console.log(\"error has accurred fetching properties: \" + err)});\n                if(event.dbIdArray != undefined && this.modelLoaded && !this.selectionStarted){\n                    this.selectionStarted = true\n                    console.log(\"starting search\");\n                    this.viewer.search('\"' + \"Glass\" + '\"', succcallback.bind(this), errCallback, ['Material'], {searchHidden: true, includeInherited: true});\n                }\n            }\n            private isolateChildren(dbIds : number[]){\n                console.log(\"dbIds: \", dbIds);\n                let tree = this.viewer.model.getInstanceTree();\n                let leafIDs = this.getLeaves(dbIds, tree); \n                let allIds = this.getLeaves([tree.getRootId()], tree)\n                let unwanted = allIds.filter((id) => {return leafIDs.indexOf(id) < 0});\n                console.log(\"unwanted: \", unwanted);\n                console.log('leaves', leafIDs);\n                this.viewer.isolate(leafIDs);\n                for(let i of unwanted){\n                    this.viewer.impl.visibilityManager.setNodeOff(i, true);\n                }\n            }\n            private getLeaves(dbIds : number[], tree){\n                let leaves : number[] = [];\n                for(let i = 0; i < dbIds.length; i++){\n                    let subchildren = (id) =>{\n                        if(tree.getChildCount(id) === 0){\n                            leaves.push(id)\n                        }\n                        tree.enumNodeChildren(id, (child) => {subchildren(child)});\n                    }\n                    subchildren(dbIds[i]);\n                }\n                return leaves;\n            }\n            \n\n\n        };\n        /*\n        extension = (viewer, options) => {\n            desk.Viewing.Extension.call(viewer, options);\n        }\n        extension.prototype = Object.create(desk.Viewing.Extension.prototype);\n        extension.prototype.selectionChangedAgent = (event) => {\n            console.log(event.dbIdArray);\n        };\n        extension.prototype.constructor = extension;\n        extension.prototype.load = () => {\n            console.log(\"selection listener loaded\");\n            //if(this != undefined){\n                //this?.viewer.addEventListener(ExtensionGetter.Autodesk.Viewing.SELECTION_CHANGED_EVENT, selectionlistenerextension.prototype.selectionChangedAgent);\n            //}\n            return true\n        };\n        extension.prototype.unload = () => {\n            console.log(\"extension unloaded\");\n            return true\n        }\n        console.log(extension);*/\n        return x \n        };\n} \n \n\n","\"use strict\";\n\nimport powerbi from \"powerbi-visuals-api\";\nimport \"./../style/visual.less\";\n\nimport VisualConstructorOptions = powerbi.extensibility.visual.VisualConstructorOptions;\nimport VisualUpdateOptions = powerbi.extensibility.visual.VisualUpdateOptions;\nimport IVisual = powerbi.extensibility.visual.IVisual;\nimport {ExtensionGetter} from \"./ExtensionGetter\"\nlet htmlText : string = 'no rendering?'\nlet viewId : string = 'forge-viewer';\nlet extensionid : string = 'selection_listener_extension';\n\nexport class Visual implements IVisual {\n    private target: HTMLElement;\n    private updateCount: number;\n    private textNode: Text;\n    private pbioptions: VisualConstructorOptions;\n    private forgeviewer : Autodesk.Viewing.GuiViewer3D;\n    private client_id : string | undefined;\n    private client_secret : string | undefined;\n    private autorefresh : boolean;\n    private accessToken : string | undefined;\n    private urn : string | undefined;\n\n    constructor(options: VisualConstructorOptions) {\n        console.log('Visual constructor', options);\n        this.pbioptions = options;\n        this.target = options.element;\n        this.target.innerText = htmlText;\n        //this.client_id = client_id;\n        //this.client_secret = client_secret;\n        console.log(this.target); \n        //let cl = () => {console.log(\"finished authenticating\"); this.initializeViewer(viewId)}; \n        //this.syncauth(cl);\n        this.onLoadSuccess = this.onLoadSuccess.bind(this);\n    }\n\n    private async syncauth(succcallback : Function){\n        console.log(\"authenticate\");\n        let fetched = await fetch(\n            \"https://developer.api.autodesk.com/authentication/v1/authenticate\",\n            {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\n            },\n            body: new URLSearchParams({\n                'client_id': this.client_id,\n                'client_secret': this.client_secret,\n                'grant_type': 'client_credentials',\n                'scope': 'viewables:read'\n                })\n            }\n        )\n\n        let jason = await fetched.json();\n        this.accessToken = jason.access_token;\n        console.log(\"reached end of authentication\");\n        console.log(this.accessToken);\n        succcallback();\n    }\n\n\n    public update(options: VisualUpdateOptions) {\n        /*console.log('Visual update', options);\n        console.log(options.dataViews);*/\n        let cat = options.dataViews[0].categorical;\n        //console.log(cat.values[0]);\n        let curcred : string[] = [this.client_id, this.client_secret, this.urn];\n        this.urn = cat.values[0].values[0] instanceof String || typeof cat.values[0].values[0] === 'string'  ? cat.values[0].values[0] as string : undefined; \n        this.client_id = cat.values[1].values[0] instanceof String || typeof cat.values[1].values[0] === 'string'  ? cat.values[1].values[0] as string : undefined;\n        this.client_secret = cat.values[2].values[0] instanceof String || typeof cat.values[2].values[0] === 'string'  ? cat.values[2].values[0] as string : undefined\n\n        console.log(curcred, [this.client_id, this.client_secret, this.urn]);\n\n        if(this.client_id != undefined && this.client_secret != undefined && this.urn != undefined){\n            if(this.forgeviewer === undefined){\n                console.log(\"strapped\");\n                let cl = () => {console.log(\"finished authenticating\"); this.initializeViewer(viewId)}; \n                this.syncauth(cl);\n            }\n            else{\n               console.info(\"updating\");\n               if(this.client_id != curcred[0]){\n                   console.info(\"changing account\");\n                   this.syncauth(() => {\n                       console.log(\"finished authenticating\");\n                       this.forgeviewer.finish();\n                       this.forgeviewer = undefined;\n                       this.initializeViewer(viewId);\n                   });\n               }\n               else if(this.urn != curcred[2]){\n                   Autodesk.Viewing.Document.load('urn:' + this.urn, this.onLoadSuccess, this.onLoadFailure)\n               }\n            }\n        }\n    }\n\n    public async initializeViewer(viewerDiv : string) : Promise<void>{\n        let aT = this.accessToken;\n        let options = {\n        env: 'AutodeskProduction',\n        api: 'derivativeV2', \n        getAccessToken: (onTokenReady : any) =>{ \n            let timeInSeconds = 3599; \n            onTokenReady(aT, timeInSeconds); \n            }\n        }\n\n        await this.getForgeviewerStyleAndSrc();\n\n        Autodesk.Viewing.Initializer(options, () =>{\n                console.log(\"getting started\");\n                let config = {extensions: ['Autodesk.ViewCubeUi',\n                     extensionid]};\n                this.forgeviewer = new Autodesk.Viewing.GuiViewer3D(document.getElementById(viewerDiv), config);\n                console.log(this.forgeviewer.start());\n                this.myloadExtension('Autodesk.ViewCubeUi', (res) => {res.setVisible(false);});\n                Autodesk.Viewing.Document.load('urn:' + this.urn, this.onLoadSuccess, this.onLoadFailure);\n            });\n    }\n\n    private async getForgeviewerStyleAndSrc() : Promise<void>{\n        console.log(\"getting style\");\n        return new Promise<void>((resolve, reject) =>{\n            let forgeViewerStyle = \"https://developer.api.autodesk.com/modelderivative/v2/viewers/style.min.css\" \n            let forgeViewerSrc = \"https://developer.api.autodesk.com/modelderivative/v2/viewers/viewer3D.js\"\n            //let securityIssue = document.createElement('meta');\n            let forgeViewerjs = document.createElement(\"script\");\n            let forgeViewercss = document.createElement(\"link\");\n            let forgeViewerDiv = document.createElement(\"div\");\n            \n            //securityIssue.httpEquiv = \"Content-Security-Policy\";\n            //securityIssue.content = \"script-src 'self' data: gap:  https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/viewer3D.min.js 'unsafe-eval' 'unsafe-inline'; object-src 'self'; style-src 'self' data: gap: https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/style.min.css  'unsafe-inline'; media-src *\";\n            forgeViewerjs.src = forgeViewerSrc;\n            forgeViewercss.href = forgeViewerStyle; \n            forgeViewercss.rel = 'stylesheet'; \n            forgeViewercss.type = 'text/css';\n            forgeViewerDiv.id = viewId;\n            forgeViewerjs.onload = () =>{\n                console.log(\"script loaded\");\n                let extension = ExtensionGetter.SelectDesk(Autodesk);\n                Autodesk.Viewing.theExtensionManager.registerExtension(extensionid, extension)\n                this.target.appendChild(forgeViewercss);\n                this.target.appendChild(forgeViewerDiv);\n                resolve();\n            }\n            //document.head.appendChild(securityIssue);\n            this.target.appendChild(forgeViewerjs);\n           \n        }) \n    }\n\n    private onLoadSuccess(doc :Autodesk.Viewing.Document){\n        console.log(\"SUCCESS\");\n        this.forgeviewer.loadDocumentNode(doc, doc.getRoot().getDefaultGeometry())\n\n    }\n    private onLoadFailure(errorCode){\n        console.log(\"load error: \" + errorCode);\n    }\n    private async myloadExtension(name : string, succcallback : Function){\n        this.forgeviewer.loadExtension(name).then((res) => {succcallback(res)});\n    } \n}\n","module.exports = Function('return this')();","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { Visual } from \"../../src/visual\";\nimport powerbiVisualsApi from \"powerbi-visuals-api\";\nimport IVisualPlugin = powerbiVisualsApi.visuals.plugins.IVisualPlugin;\nimport VisualConstructorOptions = powerbiVisualsApi.extensibility.visual.VisualConstructorOptions;\nimport DialogConstructorOptions = powerbiVisualsApi.extensibility.visual.DialogConstructorOptions;\nvar powerbiKey: any = \"powerbi\";\nvar powerbi: any = window[powerbiKey];\nvar pbiviewertestB15982BC11F74E40B7A6B4503F50947D_DEBUG: IVisualPlugin = {\n    name: 'pbiviewertestB15982BC11F74E40B7A6B4503F50947D_DEBUG',\n    displayName: 'pbi_viewer_test',\n    class: 'Visual',\n    apiVersion: '5.1.0',\n    create: (options: VisualConstructorOptions) => {\n        if (Visual) {\n            return new Visual(options);\n        }\n        throw 'Visual instance not found';\n    },\n    createModalDialog: (dialogId: string, options: DialogConstructorOptions, initialState: object) => {\n        const dialogRegistry = globalThis.dialogRegistry;\n        if (dialogId in dialogRegistry) {\n            new dialogRegistry[dialogId](options, initialState);\n        }\n    },\n    custom: true\n};\nif (typeof powerbi !== \"undefined\") {\n    powerbi.visuals = powerbi.visuals || {};\n    powerbi.visuals.plugins = powerbi.visuals.plugins || {};\n    powerbi.visuals.plugins[\"pbiviewertestB15982BC11F74E40B7A6B4503F50947D_DEBUG\"] = pbiviewertestB15982BC11F74E40B7A6B4503F50947D_DEBUG;\n}\nexport default pbiviewertestB15982BC11F74E40B7A6B4503F50947D_DEBUG;"],"names":[],"sourceRoot":""}